# üé≠ Telegram-–±–æ—Ç "–û—Ç–º–∞–∑–æ—á–Ω–∏–∫" v2.0

> **Production-ready –±–æ—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–º–∞–∑–æ–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM**

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–º–∞–∑–∫–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≥–æ–ª–æ—Å–æ–≤—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é.

**üöÄ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–æ—Ç–∞: [@kolyanius_fu_bot](https://t.me/kolyanius_fu_bot)**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ v2.0](#-–Ω–æ–≤—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏-v20)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#-–¥–µ—Ç–∞–ª—å–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏](#-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–º–∏–≥—Ä–∞—Ü–∏–∏)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–±–æ—Ç–∞)
- [API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#-api-–∏-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏](#-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏)
- [Troubleshooting](#-troubleshooting)
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

---

## ‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ v2.0

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—á–∏

- **üëçüëé –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** - –û—Ü–µ–Ω–∏–≤–∞–π –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–º–∞–∑–æ–∫
- **üîÑ –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –ü–æ–ª—É—á–∞–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º
- **üìú –ò—Å—Ç–æ—Ä–∏—è** - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –æ—Ç–º–∞–∑–æ–∫
- **‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ** - –°–æ—Ö—Ä–∞–Ω—è–π –ª—É—á—à–∏–µ –æ—Ç–º–∞–∑–∫–∏
- **üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** - –û—Ç–ø—Ä–∞–≤–ª—è–π –≥–æ–ª–æ—Å–æ–º, –ø–æ–ª—É—á–∞–π —Ç–µ–∫—Å—Ç–æ–º
- **üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –ª—é–±–∏–º—ã–µ —Å—Ç–∏–ª–∏
- **üóÑÔ∏è PostgreSQL** - –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **üîê Production-ready** - –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### üé® 4 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç–∏–ª—è

- **üí™ –ë—ã–¥–ª–æ** - –ì—Ä—É–±–æ–≤–∞—Ç—ã–µ, –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω—ã–µ –æ—Ç–º–∞–∑–∫–∏ —Å –∂–∞—Ä–≥–æ–Ω–æ–º
- **üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç** - –î–µ–ª–æ–≤—ã–µ, –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–º–∞–∑–∫–∏ –≤ –æ—Ñ–∏—Å–Ω–æ–º —Å—Ç–∏–ª–µ
- **üôè –ú–æ–Ω–∞—Ö** - –§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–µ, –º—É–¥—Ä—ã–µ –æ—Ç–º–∞–∑–∫–∏ —Å –¥—É—Ö–æ–≤–Ω—ã–º –ø–æ–¥—Ç–µ–∫—Å—Ç–æ–º
- **üîÆ –ò–Ω—Ñ–æ—Ü—ã–≥–∞–Ω** - –ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ, —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–µ –æ—Ç–º–∞–∑–∫–∏ —Å –º–∞–≥–∏–µ–π
- **üé≤ –°–ª—É—á–∞–π–Ω—ã–π** - –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –∏–∑ –≤—Å–µ—Ö —Å—Ç–∏–ª–µ–π

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/yourusername/kolyanius_fu_bot.git
cd kolyanius_fu_bot
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏–∑ —à–∞–±–ª–æ–Ω–∞:

```bash
cp env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
TELEGRAM_BOT_TOKEN=your_bot_token_here
OPENROUTER_API_KEY=your_openrouter_key_here

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
LLM_BASE_URL=https://gptunnel.ru/v1
DATABASE_URL=postgresql+asyncpg://botuser:botpassword@postgres:5432/otmazochnik
```

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

#### Telegram Bot Token:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ `.env` —Ñ–∞–π–ª

#### OpenRouter API Key:
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [OpenRouter](https://openrouter.ai)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª API Keys
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –≤ `.env` —Ñ–∞–π–ª

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [gptunnel.ru](https://gptunnel.ru) –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
docker compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down
```

**–ì–æ—Ç–æ–≤–æ!** –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é üéâ

---

## üîß –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|----------|-------------|--------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | ‚úÖ | - |
| `OPENROUTER_API_KEY` | API –∫–ª—é—á OpenRouter | ‚úÖ | - |
| `LLM_BASE_URL` | URL LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ | ‚ùå | `https://gptunnel.ru/v1` |
| `DATABASE_URL` | URL PostgreSQL –±–∞–∑—ã | ‚ùå | `postgresql+asyncpg://...` |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | ‚ùå | `INFO` |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LLM –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ò–∑–º–µ–Ω–∏—Ç–µ –≤ `app/config.py`:

```python
MODEL_NAME: str = "gpt-4o"       # –ú–æ–¥–µ–ª—å LLM
MAX_TOKENS: int = 500            # –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤
TEMPERATURE: float = 0.7         # –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (0.0 - 1.0)
RETRY_COUNT: int = 1             # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤
MAX_MESSAGE_LENGTH: int = 200    # –õ–∏–º–∏—Ç –¥–ª–∏–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π PostgreSQL

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `docker-compose.yml`:

```yaml
postgres:
  environment:
    - POSTGRES_DB=otmazochnik
    - POSTGRES_USER=your_custom_user
    - POSTGRES_PASSWORD=your_secure_password
```

–û–±–Ω–æ–≤–∏—Ç–µ `DATABASE_URL` –≤ `.env`:

```bash
DATABASE_URL=postgresql+asyncpg://your_custom_user:your_secure_password@postgres:5432/otmazochnik
```

#### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–µ–π –ë–î

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å PostgreSQL —Å–µ—Ä–≤–µ—Ä:

1. –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ü–∏—é `postgres` –≤ `docker-compose.yml`
2. –ò–∑–º–µ–Ω–∏—Ç–µ `DATABASE_URL` –≤ `.env` –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
kolyanius_fu_bot/
‚îú‚îÄ‚îÄ app/                        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py            # Package metadata
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # Entry point, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                 # Telegram handlers (v2.0)
‚îÇ   ‚îú‚îÄ‚îÄ llm_client.py          # OpenRouter API client
‚îÇ   ‚îú‚îÄ‚îÄ database.py            # Database service layer (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # SQLAlchemy models (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ prompts.py             # LLM –ø—Ä–æ–º–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ styles.py              # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π
‚îÇ
‚îú‚îÄ‚îÄ alembic/                   # Database migrations (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ versions/              # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ env.py                 # Alembic –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ script.py.mako         # –®–∞–±–ª–æ–Ω –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ
‚îú‚îÄ‚îÄ logs/                      # –õ–æ–≥–∏ (runtime)
‚îÇ   ‚îú‚îÄ‚îÄ app.log               # –û–±—â–∏–µ —Å–æ–±—ã—Ç–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ errors.log            # –û—à–∏–±–∫–∏ —Å —Ç—Ä–µ–π—Å–±—ç–∫–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ requests.log          # –ó–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ
‚îú‚îÄ‚îÄ doc/                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ product_idea.md       # –ò–¥–µ—è –ø—Ä–æ–¥—É–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ vision.md             # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –≤–∏–¥–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ tasklist.md           # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ workflow.md           # –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ conventions.md        # Coding conventions
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker Compose config
‚îú‚îÄ‚îÄ Dockerfile                 # Docker image definition
‚îú‚îÄ‚îÄ requirements.txt           # Python dependencies
‚îú‚îÄ‚îÄ alembic.ini               # Alembic configuration (NEW)
‚îú‚îÄ‚îÄ env.example               # –®–∞–±–ª–æ–Ω .env —Ñ–∞–π–ª–∞
‚îú‚îÄ‚îÄ .gitignore                # Git exclusions
‚îú‚îÄ‚îÄ README.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ CLAUDE.md                 # Claude Code guidelines
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `users`
```sql
- user_id (BigInteger, PK)          # Telegram User ID
- username (String)                  # @username
- first_name (String)                # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- created_at (DateTime)              # –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- last_active (DateTime)             # –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- default_style (String, nullable)   # –õ—é–±–∏–º—ã–π —Å—Ç–∏–ª—å
- is_premium (Boolean)               # Premium —Å—Ç–∞—Ç—É—Å
```

#### –¢–∞–±–ª–∏—Ü–∞ `excuses`
```sql
- id (Integer, PK, autoincrement)    # ID –æ—Ç–º–∞–∑–∫–∏
- user_id (BigInteger, FK)           # –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- original_message (Text)            # –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- style (String)                     # –í—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å
- generated_text (Text)              # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ç–º–∞–∑–∫–∞
- created_at (DateTime, indexed)     # –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
- rating (Integer, nullable)         # –û—Ü–µ–Ω–∫–∞: 1 (üëç) –∏–ª–∏ -1 (üëé)
- response_time (Float, nullable)    # –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Å–µ–∫—É–Ω–¥—ã)
```

#### –¢–∞–±–ª–∏—Ü–∞ `favorites`
```sql
- id (Integer, PK, autoincrement)    # ID –∑–∞–ø–∏—Å–∏
- user_id (BigInteger, FK)           # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- excuse_id (Integer, FK)            # –û—Ç–º–∞–∑–∫–∞
- created_at (DateTime)              # –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
```

### –†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏
alembic revision --autogenerate -m "Description of changes"

# –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic revision -m "Description of changes"
```

#### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é
alembic upgrade <revision_id>

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
alembic downgrade -1

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏
alembic history

# –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è
alembic current
```

#### –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤ Docker

–ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ `app/database.py:init_database()`.

–î–ª—è —Ä—É—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

```bash
# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose exec bot sh

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î

```bash
# –°–æ–∑–¥–∞—Ç—å backup
docker compose exec postgres pg_dump -U botuser otmazochnik > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
docker compose exec -T postgres psql -U botuser otmazochnik < backup.sql
```

---

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

- `/start` - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/help` - –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–∏–ª–µ–π –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `/history` - –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –æ—Ç–º–∞–∑–æ–∫
- `/favorites` - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –æ—Ç–º–∞–∑–æ–∫
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

#### 1. –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
- **–¢–µ–∫—Å—Ç–æ–º:** –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é (–º–∞–∫—Å 200 —Å–∏–º–≤–æ–ª–æ–≤)
- **–ì–æ–ª–æ—Å–æ–º:** –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)

#### 2. –í—ã–±–æ—Ä —Å—Ç–∏–ª—è
–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:
- üí™ –ë—ã–¥–ª–æ
- üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç
- üôè –ú–æ–Ω–∞—Ö
- üîÆ –ò–Ω—Ñ–æ—Ü—ã–≥–∞–Ω
- üé≤ –°–ª—É—á–∞–π–Ω—ã–π —Å—Ç–∏–ª—å

#### 3. –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–µ–π—Å—Ç–≤–∏—è:
- **üëç / üëé** - –û—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ
- **‚≠ê –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ** - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–º–∞–∑–∫—É
- **üîÑ –î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç** - –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–æ–º –∂–µ —Å—Ç–∏–ª–µ

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ü—Ä–∏–º–µ—Ä 1: –¢–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
```
User: –Ω–µ —Å–¥–µ–ª–∞–ª –æ—Ç—á—ë—Ç
Bot: –í—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å –¥–ª—è –æ—Ç–º–∞–∑–∫–∏:
     [üí™ –ë—ã–¥–ª–æ] [üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç] [üôè –ú–æ–Ω–∞—Ö] [üîÆ –ò–Ω—Ñ–æ—Ü—ã–≥–∞–Ω] [üé≤ –°–ª—É—á–∞–π–Ω—ã–π]

User: [–Ω–∞–∂–∏–º–∞–µ—Ç üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç]
Bot: –°—Ç–∏–ª—å: üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç

     –í —Å–≤—è–∑–∏ —Å —Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä–Ω—ã–º–∏ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
     –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–∫—É—â–µ–≥–æ –≤–æ—Ä–∫—Ñ–ª–æ—É, —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
     –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ –±—ã–ª–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç.

     [üëç] [üëé] [‚≠ê –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ]
     [üîÑ –î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç]
```

#### –ü—Ä–∏–º–µ—Ä 2: –ì–æ–ª–æ—Å–æ–≤–æ–π –∑–∞–ø—Ä–æ—Å
```
User: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ "–Ω–µ —É—Å–ø–µ–ª –Ω–∞ –≤—Å—Ç—Ä–µ—á—É"]
Bot: üé§ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...
     –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: –Ω–µ —É—Å–ø–µ–ª –Ω–∞ –≤—Å—Ç—Ä–µ—á—É

     –í—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å –¥–ª—è –æ—Ç–º–∞–∑–∫–∏:
     [üí™ –ë—ã–¥–ª–æ] [üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç] [üôè –ú–æ–Ω–∞—Ö] [üîÆ –ò–Ω—Ñ–æ—Ü—ã–≥–∞–Ω] [üé≤ –°–ª—É—á–∞–π–Ω—ã–π]
```

#### –ü—Ä–∏–º–µ—Ä 3: –ò—Å—Ç–æ—Ä–∏—è –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
```
User: /history
Bot: üìú –¢–≤–æ—è –∏—Å—Ç–æ—Ä–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –æ—Ç–º–∞–∑–æ–∫):

     1. üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç üëç
        –Ω–µ —Å–¥–µ–ª–∞–ª –æ—Ç—á—ë—Ç...
        –í —Å–≤—è–∑–∏ —Å —Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä–Ω—ã–º–∏...

     2. üí™ –ë—ã–¥–ª–æ
        –æ–ø–æ–∑–¥–∞–ª –Ω–∞ —Ä–∞–±–æ—Ç—É...
        –ë—Ä–∞—Ç–∞–Ω, –∞–≤—Ç–æ–±—É—Å –∫–∞–ø–µ—Ü –∫–∞–∫...
     ...

User: /favorites
Bot: ‚≠ê –¢–≤–æ—ë –∏–∑–±—Ä–∞–Ω–Ω–æ–µ (3 –æ—Ç–º–∞–∑–∫–∏):

     1. üíº –ö–æ—Ä–ø–æ—Ä–∞—Ç
        –Ω–µ —Å–¥–µ–ª–∞–ª –æ—Ç—á—ë—Ç...
        –í —Å–≤—è–∑–∏ —Å —Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä–Ω—ã–º–∏ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏...
     ...
```

---

## üîå API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### LLM Provider

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **OpenRouter** –∏–ª–∏ **gptunnel.ru** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ GPT-4o.

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏
- `gpt-4o` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `gpt-4o-mini` (–±—ã—Å—Ç—Ä–µ–µ, –¥–µ—à–µ–≤–ª–µ)
- `gpt-3.5-turbo` (–±—é–¥–∂–µ—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)

–ò–∑–º–µ–Ω–∏—Ç–µ –≤ `app/config.py`:
```python
MODEL_NAME: str = "gpt-4o-mini"  # –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
```

### Voice Transcription

–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ **OpenAI Whisper API**.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –§–æ—Ä–º–∞—Ç: OGG, MP3, WAV
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 10 –º–∏–Ω—É—Ç
- –Ø–∑—ã–∫: –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ)

### Database Access

–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ë–î:

```python
from app import database as db

# –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
excuses = await db.get_user_history(user_id=123456789, limit=10)

# –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
await db.add_to_favorites(user_id=123456789, excuse_id=42)

# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
stats = await db.get_user_stats(user_id=123456789)
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–æ–≤:

#### 1. `logs/app.log` - –û–±—â–∏–µ —Å–æ–±—ã—Ç–∏—è
```
2025-01-08 12:00:00 - app - INFO - üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ '–û—Ç–º–∞–∑–æ—á–Ω–∏–∫'
2025-01-08 12:00:01 - app - INFO - üóÑÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
2025-01-08 12:00:02 - app - INFO - ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞
2025-01-08 12:00:03 - app - INFO - ü§ñ Telegram –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
```

#### 2. `logs/errors.log` - –û—à–∏–±–∫–∏ —Å —Ç—Ä–µ–π—Å–±—ç–∫–∞–º–∏
```
2025-01-08 12:15:30 - error - ERROR - API_ERROR | User: 123456789 | Style: –±—ã–¥–ª–æ | Error: Timeout
Traceback (most recent call last):
  ...
```

#### 3. `logs/requests.log` - –ó–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```
2025-01-08 12:10:00 - requests - INFO - MESSAGE | User: 123456789 (@username) | Text: '–Ω–µ —Å–¥–µ–ª–∞–ª –æ—Ç—á—ë—Ç' | Length: 15
2025-01-08 12:10:05 - requests - INFO - STYLE_SELECTED | User: 123456789 (@username) | Selected: –∫–æ—Ä–ø–æ—Ä–∞—Ç | Actual: –∫–æ—Ä–ø–æ—Ä–∞—Ç
2025-01-08 12:10:08 - requests - INFO - SUCCESS | User: 123456789 | Style: –∫–æ—Ä–ø–æ—Ä–∞—Ç | Time: 2.34s | Length: 145 | Attempts: 1
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (Docker)
docker compose logs -f bot

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
tail -f logs/app.log
tail -f logs/errors.log
tail -f logs/requests.log

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
grep ERROR logs/errors.log

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
grep "User: 123456789" logs/requests.log
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
grep "SUCCESS" logs/requests.log | awk '{print $14}' | sort -n

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Å—Ç–∏–ª—è–º
grep "STYLE_SELECTED" logs/requests.log | awk '{print $13}' | sort | uniq -c

# –û—à–∏–±–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
tail -n 1000 logs/errors.log | grep "$(date '+%Y-%m-%d %H')"
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Error: TELEGRAM_BOT_TOKEN is required
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` —Ñ–∞–π–ª
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–∫–µ–Ω —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `docker compose down && docker compose up -d`

---

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Error connecting to database
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PostgreSQL
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ë–î
docker compose logs postgres

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î
docker compose down -v
docker compose up -d
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: LLM API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
```
LLM request timeout
Rate limit exceeded
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ OpenRouter
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `LLM_BASE_URL`
3. –£–≤–µ–ª–∏—á—å—Ç–µ timeout –≤ `app/llm_client.py`:
```python
timeout=30.0  # –±—ã–ª–æ 15.0
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Error in voice_handler
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á OpenRouter (Whisper —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–≥–æ –∂–µ –∫–ª—é—á–∞)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–¥–µ–ª—å `whisper-1` –¥–æ—Å—Ç—É–ø–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ (–º–∞–∫—Å 25 MB)

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Target database is not up to date
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose exec bot sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
alembic current

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é
alembic upgrade head

# –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - —Å–±—Ä–æ—Å–∏—Ç—å –ë–î
docker compose down -v
docker compose up -d
```

---

## üë®‚Äçüíª –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL –ª–æ–∫–∞–ª—å–Ω–æ
brew install postgresql  # macOS
sudo apt install postgresql  # Ubuntu

# –°–æ–∑–¥–∞—Ç—å –ë–î
createdb otmazochnik

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python -m app.main
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ LLM

```bash
# –¢–µ—Å—Ç LLM –∫–ª–∏–µ–Ω—Ç–∞
python test_llm.py

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
# ‚úÖ Environment variables loaded
# ‚úÖ OpenAI client created
# ‚úÖ Sync request successful
# ‚úÖ Async request successful
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç–∏–ª–µ–π

1. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç–∏–ª—å –≤ `app/styles.py`:
```python
STYLES = {
    "–Ω–æ–≤—ã–π_—Å—Ç–∏–ª—å": {
        "name": "–ù–æ–≤—ã–π —Å—Ç–∏–ª—å",
        "emoji": "üé®",
        "description": "–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∏–ª—è"
    }
}
```

2. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–º–ø—Ç –≤ `app/prompts.py`:
```python
EXCUSE_PROMPTS = {
    "–Ω–æ–≤—ã–π_—Å—Ç–∏–ª—å": """–ü—Ä–æ–º–ø—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å—Ç–∏–ª—è..."""
}
```

3. –û–±–Ω–æ–≤–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤ `app/bot.py:create_style_keyboard()`

### Deployment –≤ production

#### –ù–∞ VPS —Å Docker

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
git clone https://github.com/yourusername/kolyanius_fu_bot.git
cd kolyanius_fu_bot
cp env.example .env
nano .env  # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# –ó–∞–ø—É—Å–∫
docker compose up -d

# Auto-restart –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
sudo systemctl enable docker
```

#### –ù–∞ –æ–±–ª–∞—á–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

- **Railway.app**: –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –∏–∑ GitHub
- **Render.com**: Docker Compose support
- **DigitalOcean App Platform**: Managed PostgreSQL

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues:** [GitHub Issues](https://github.com/yourusername/kolyanius_fu_bot/issues)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `doc/` –ø–∞–ø–∫–∞
- **Email:** your.email@example.com

---

## üéØ Roadmap

- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Telegram Mini App)
- [ ] –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å (EN, UA)
- [ ] Premium –ø–æ–¥–ø–∏—Å–∫–∞
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤ PDF
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞–º–∏

---

**üé≠ –ë–æ—Ç –≥–æ—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–º–∞–∑–∫–∏ –≤ production-—Ä–µ–∂–∏–º–µ!**

_Made with ‚ù§Ô∏è using Python, aiogram, PostgreSQL, and GPT-4o_
